---
title: NPM
date: 2017-10-23
type: article
tags:
  - npm
subSidebar: true
---
[npmå®˜ç½‘](å®˜ç½‘ï¼šhttps://www.npmjs.com/) [npmä¸­æ–‡ç½‘](https://www.npmjs.cn/)

> åŒ…ç®¡ç†å·¥å…· <br>
æ¯ç§ä¸»æµç¼–ç¨‹è¯­è¨€éƒ½æœ‰åŒ…ç®¡ç†å·¥å…·ï¼Œæ¯”å¦‚ java çš„ Mavenã€Gradleï¼ŒPython çš„ pipï¼Œphpçš„composerã€‚å¯¹äºå‰ç«¯æ¥è¯´ï¼Œä¾èµ–åŒ…ç®¡ç†å·¥å…·ä¸»è¦æœ‰ npmã€yarnã€pnpmã€‚

## npm ç®€ä»‹

NPMçš„å…¨ç§°æ˜¯NodeJs Package Managerï¼ˆNodejsåŒ…ç®¡ç†å™¨ï¼‰ï¼Œå®ƒæ˜¯éšNodeä¸€èµ·å®‰è£…çš„ã€‚npm èƒ½åšä»€ä¹ˆï¼š

- ä»NPMæœåŠ¡å™¨ä¸‹è½½åˆ«äººå†™å¥½çš„åŒ…æˆ–è€…å‘½ä»¤è¡Œç¨‹åºåˆ°æœ¬åœ°ç›´æ¥ä½¿ç”¨
- å°†è‡ªå·±å†™å¥½çš„åŒ…æˆ–å‘½ä»¤è¡Œç¨‹åºä¸Šä¼ åˆ°NPMæœåŠ¡å™¨ä¾›åˆ«äººä½¿ç”¨

::: warning ä¸ºä»€ä¹ˆéœ€è¦åŒ…ç®¡ç†å™¨ï¼Ÿ
æˆ‘ä»¬åœ¨Node.jsä¸Šå¼€å‘æ—¶ï¼Œä¼šç”¨åˆ°å¾ˆå¤šåˆ«äººå†™çš„JavaScriptä»£ç ã€‚å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨åˆ«äººå†™çš„æŸä¸ªåŒ…ï¼Œæ¯æ¬¡éƒ½æ ¹æ®åç§°æœç´¢ä¸€ä¸‹å®˜æ–¹ç½‘ç«™ï¼Œä¸‹è½½ä»£ç ï¼Œè§£å‹ï¼Œscript å¼•å…¥ï¼Œéå¸¸ç¹çã€‚äºæ˜¯ä¸€ä¸ªé›†ä¸­ç®¡ç†çš„å·¥å…·åº”è¿è€Œç”Ÿï¼šå¤§å®¶éƒ½æŠŠè‡ªå·±å¼€å‘çš„æ¨¡å—æ‰“åŒ…åæ”¾åˆ°npmå®˜ç½‘ä¸Šï¼Œå¦‚æœè¦ä½¿ç”¨ï¼Œç›´æ¥é€šè¿‡npmå®‰è£…å°±å¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨ç®¡ä»£ç å­˜åœ¨å“ªï¼Œåº”è¯¥ä»å“ªä¸‹è½½ã€‚
æ›´é‡è¦çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨æ¨¡å—Aï¼Œè€Œæ¨¡å—Aåˆä¾èµ–äºæ¨¡å—Bï¼Œæ¨¡å—Båˆä¾èµ–äºæ¨¡å—Xå’Œæ¨¡å—Yï¼Œnpmå¯ä»¥æ ¹æ®ä¾èµ–å…³ç³»ï¼ŒæŠŠæ‰€æœ‰ä¾èµ–çš„åŒ…éƒ½ä¸‹è½½ä¸‹æ¥å¹¶ç®¡ç†èµ·æ¥ã€‚å¦åˆ™ï¼Œé æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨ç®¡ç†ï¼Œè‚¯å®šæ—¢éº»çƒ¦åˆå®¹æ˜“å‡ºé”™ã€‚
:::

npmè§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯`æ¨¡å—ç®¡ç†`é—®é¢˜ï¼ŒnpmåŒ…å«cliè„šæ‰‹æ¶ã€æ¨¡å—ä»“åº“ã€[å®˜ç½‘](https://www.npmjs.com/) ä¸‰å¤§éƒ¨åˆ†ã€‚

## npm åŸºæœ¬ä½¿ç”¨

### 1. å®‰è£…æ›´æ–°

npm ä¸éœ€è¦ç‰¹æ„å®‰è£…ï¼Œåœ¨å®‰è£…nodeçš„æ—¶å€™ï¼Œä¼šè¿å¸¦ä¸€èµ·å®‰è£…ï¼Œä½†æœ‰å¯èƒ½å®‰è£…çš„npmä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œéœ€è¦å‡çº§ä¸€ä¸‹ã€‚

```bash
# å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬
sudo npm install npm@latest -g

# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
npm -v
```

### 2. å®‰è£…ä¾èµ–æ¨¡å—

```bash
npm install <Module Name>

# ç¼©å†™
npm i <Module Name>

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
npm i jquery@3.0.0

# å®‰è£…ä¾èµ–ä¿¡æ¯æ”¾å…¥åˆ°package.jsonçš„dependenciesæ¨¡å—
npm i axios --save // --save  æˆ–è€… -S

# å®‰è£…ä¾èµ–ä¿¡æ¯æ”¾å…¥åˆ°package.jsonçš„devDependenciesæ¨¡å—
npm i webpack --save-dev  // --save-dev -D

# å®‰è£…ä¹‹å‰ï¼Œnpm install ä¼šå…ˆæ£€æŸ¥ï¼Œnode_modules ç›®å½•ä¹‹ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŒ‡å®šæ¨¡å—ã€‚å¦‚æœå­˜åœ¨ï¼Œå°±ä¸å†é‡æ–°å®‰è£…äº†ï¼Œå³ä½¿è¿œç¨‹ä»“åº“å·²ç»æœ‰äº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœä½ å¸Œæœ›ï¼Œä¸€ä¸ªæ¨¡å—ä¸ç®¡æ˜¯å¦å®‰è£…è¿‡ï¼Œ npm éƒ½è¦å¼ºåˆ¶é‡æ–°å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ -f æˆ– â€“force å‚æ•°ã€‚
npm i webpack --force

# å¯ä»¥æ¥æ”¶ä¸€ä¸ªurlåœ°å€
npm i <git url>
```

å®‰è£…å¥½åï¼ŒåŠŸèƒ½æ¨¡å—æ”¾åœ¨<font style="color:red">node_modules</font>ç›®å½•ä¸­, ä»£ç ä¸­é€šè¿‡require('Module Name')çš„æ–¹å¼å¼•å…¥ã€‚

```javascript
var mModule = require('Module Name');
```

### 3. å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…

npmåŒ…å®‰è£…åˆ†ä¸ºæœ¬åœ°å®‰è£…(local)ã€å…¨å±€å®‰è£…(global)ä¸¤ç§ï¼š

**æœ¬åœ°å®‰è£…**

- å°†å®‰è£…åŒ…å­˜æ”¾åœ¨`./node_modules`ç›®å½•ä¸‹ï¼ˆè¿è¡Œnpmå‘½ä»¤æ—¶æ‰€åœ¨çš„å½“å‰å·¥ä½œç›®å½•ï¼‰ï¼Œå¦‚æœæ²¡æœ‰node_modulesç›®å½•ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆnode_modulesç›®å½•ã€‚
- é€šè¿‡`require()`æ¥å¼•å…¥æœ¬åœ°å®‰è£…çš„åŒ…

**å…¨å±€å®‰è£…**

- å°†åŒ…å­˜æ”¾åˆ°nodeçš„å®‰è£…ç›®å½•ï¼Œæˆ–è€…æŒ‡å®šçš„åŒ…å­˜æ”¾ç›®å½•
- ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œæ‰§è¡Œ

```bash
npm i jquery -g  # å…¨å±€å®‰è£…jquery
npm i jquery  # æœ¬åœ°å®‰è£…jquery

> npm root -g # æŸ¥çœ‹å…¨å±€å®‰è£…çš„ä½ç½®ï¼Œå‘½ä»¤ä¼šå‘ŠçŸ¥å…¶å…¨å±€å®‰è£…è·¯å¾„åœ¨è®¡ç®—æœºä¸Šçš„ç¡®åˆ‡ä½ç½®
/usr/local/lib/node_modules

# ä¸€æ¬¡å®‰è£…å¤šä¸ªåŒ…
> npm i express momemt lodash mongoose body-parser webpack
```

### 4. å¸è½½æ¨¡å—

```bash
# å¸è½½expressæ¨¡å—
npm uninstall express

# æŸ¥çœ‹æ˜¯å¦è¿˜å­˜åœ¨äºnode_modulesç›®å½•ä¸‹
npm ls
```

### 5. æ›´æ–°ä¸æœç´¢

```bash
# æ›´æ–°jqueryåˆ°æœ€æ–°ç‰ˆæœ¬
npm update jquery

# æœç´¢
npm search express

# æŸ¥çœ‹æŸä¸ªåŒ…çš„ä¿¡æ¯
npm info underscore 

npm view underscore version # æŸ¥çœ‹æŸä¸ªæ¨¡å—çš„æœ€æ–°ç‰ˆæœ¬
npm view underscore versions # æŸ¥çœ‹æŸä¸ªæ¨¡å—çš„æ‰€æœ‰å†å²ç‰ˆæœ¬
```

### 6. æŸ¥çœ‹å½“å‰å·²å®‰è£…çš„æ¨¡å—

```bash
> npm list # æŸ¥çœ‹å½“å‰å®‰è£…çš„ä¾èµ–ï¼Œåªæ˜¾ç¤ºpackage.jsonåŒ…ä¸­çš„ä¾èµ–ï¼Œä¸æ˜¾ç¤ºå­ä¾èµ–, æ ‘å½¢ç»“æ„æ˜¾ç¤º

wiki@1.0.0 /Users/guoqiangzhou/Work/javascript/wiki
â”œâ”€â”€ vuepress-plugin-copyright@1.0.2
â”œâ”€â”€ vuepress-plugin-nuggets-style-copy@1.0.3
â”œâ”€â”€ vuepress-theme-reco@1.6.17
â””â”€â”€ vuepress@1.9.10

> npm ls vuepress # æŸ¥çœ‹å®‰è£…ä¾èµ–çš„ç‰ˆæœ¬

wiki@1.0.0 /Users/guoqiangzhou/Work/javascript/wiki
â””â”€â”€ vuepress@1.9.10 

> npm outdated # -g æŸ¥çœ‹è¿‡æ—¶çš„åŒ…/æŸ¥çœ‹å…¨å±€è¿‡æ—¶çš„åŒ…
Package               Current  Wanted  Latest  Location  Depended by
@vue/compiler-dom     MISSING   3.3.8   3.3.8  -         vue
@vue/compiler-sfc     MISSING   3.3.8   3.3.8  -         vue
```

### 7. æ‰§è¡Œå‘½ä»¤

```bash
# ä¾‹å¦‚æ‰§è¡Œnpm run dev æ—¶ï¼Œç³»ç»Ÿå°±ä¼šè·‘åˆ°package.jsonæ–‡ä»¶ä¸­æ‰§è¡Œscriptsä¸­å¯¹åº”çš„è„šæœ¬
npm run [<args>] 


#dev è„šæœ¬ï¼Œå¼€å‘é˜¶æ®µè¦åšçš„å¤„ç†.devæ˜¯è‡ªå®šä¹‰å‘½ä»¤
npm run dev 
 
#serve,è„šæœ¬ç”¨äºå¯åŠ¨æœåŠ¡,serveæ˜¯è‡ªå®šä¹‰å‘½ä»¤
npm run serve
```
ç›´æ¥`npm run` å°†æ‰§è¡Œpackage.jsonæ–‡ä»¶ä¸­scriptä¸­å®šä¹‰çš„æ‰€æœ‰çš„è„šæœ¬ã€‚

## npm é…ç½®

npm é…ç½®æ˜¯æŒ‡åœ¨ä½¿ç”¨npmå‘½ä»¤è¡Œå·¥å…·æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸€äº›é…ç½®é€‰é¡¹æ¥è‡ªå®šä¹‰npmçš„è¡Œä¸ºå’ŒåŠŸèƒ½ã€‚åŒ…æ‹¬`è®¾ç½®ä»£ç†`ã€`è®¾ç½®é•œåƒæº`ã€`è®¾ç½®å…¨å±€å’Œå±€éƒ¨åŒ…çš„å®‰è£…è·¯å¾„`ã€‚

### 1. é…ç½®æ–‡ä»¶

npmrcæ˜¯npmçš„é…ç½®æ–‡ä»¶ï¼Œä½äº`/etc/`æˆ–è€…ç”¨æˆ·ä¸»ç›®å½•ä¸‹.npmrcæ–‡ä»¶æˆ–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„.npmrcæ–‡ä»¶ã€‚npmrcæ–‡ä»¶ç”±ä¸€ç³»åˆ—é”®å€¼å¯¹ç»„æˆï¼Œç”¨äºé…ç½®npmåœ¨æ‰§è¡Œå‘½ä»¤æ—¶çš„è¡Œä¸ºå’Œå‚æ•°ã€‚

npmrcçš„é…ç½®å­˜åœ¨ä¼˜å…ˆçº§ï¼Œå½“æˆ‘ä»¬åœ¨å¤šä¸ªé…ç½®æ–‡ä»¶ä¸­å®šä¹‰ç›¸åŒçš„é”®æ—¶ï¼Œnpmå°†æŒ‰ç…§ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾å’Œåº”ç”¨é…ç½®ï¼š

- é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„.npmrc æ–‡ä»¶
- ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„.npmrc æ–‡ä»¶
- å…¨å±€.npmrcæ–‡ä»¶
- npm å†…ç½®çš„é»˜è®¤é…ç½®

**æ³¨æ„**ï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„.npmrcæ–‡ä»¶ä¼˜å…ˆçº§æœ€é«˜ï¼Œå®ƒä¼šè¦†ç›–ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„é…ç½®ï¼Œè€Œç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„é…ç½®åˆä¼šè¦†ç›–npmçš„é»˜è®¤é…ç½®ã€‚

### 2. è·å–é…ç½®ä¿¡æ¯

```bash
> npm config ls

; "user" config from /Users/guoqiangzhou/.npmrc

home = "https://npmmirror.com" 
python = "/usr/local/bin/python" 
registry = "https://registry.npmmirror.com/"
...
```

é€šè¿‡`npm config ls`æŸ¥çœ‹å½“å‰npmçš„é…ç½®ä¿¡æ¯ï¼Œ`-g`æŸ¥çœ‹npmå…¨å±€ä¿¡æ¯ã€‚

```bash 
npm config get prefix  # è·å–å…¨å±€åŒ…çš„å®‰è£…è·¯å¾„ï¼Œå…·ä½“è·¯å¾„åœ¨{prefix}/lib/node_modules/
npm config get registry # è·å–npmé•œåƒæº
npm config get cache # è·å–npmåŒ…çš„ç¼“å­˜è·¯å¾„
npm config get proxy # è·å–ä»£ç†æœåŠ¡å™¨
```
é€šè¿‡`npm config get`è·å–å•é¡¹çš„é…ç½®ã€‚

### 3. è®¾ç½®é…ç½®ä¿¡æ¯

```bash
npm config set prefix /usr/local # è®¾ç½®å…¨å±€åŒ…å®‰è£…è·¯å¾„
npm config set registry https://registry.npm.taobao.org # è®¾ç½®é•œåƒæº
npm config set proxy http://10.10.5.2:8080 # è®¾ç½®npmä»£ç†
```
é€šè¿‡`npm config set`è®¾ç½®å…·ä½“å•é¡¹çš„é…ç½®ã€‚

ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®ç›¸åº”çš„å€¼ï¼š

```bash
npm config edit # ä¿®æ”¹å½“å‰é¡¹ç›®é…ç½®æ–‡ä»¶
npm config edit --global # ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶
```

### 4. åˆ é™¤é…ç½®

```bash
npm config delete prefix # åˆ é™¤prefixé…ç½®
```

## package.json æè¿°æ–‡ä»¶

package.json æ–‡ä»¶æ˜¯packageçš„æè¿°æ–‡ä»¶ï¼Œå®ƒæ˜¯Node.jsé¡¹ç›®ä¸­éå¸¸é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªé¡¹ç›®çš„æ ¸å¿ƒï¼Œè¯¥æ–‡ä»¶ä¸­è·Ÿè¸ªä¾èµ–å…³ç³»å’Œå…ƒæ•°æ®ï¼Œå®šä¹‰äº†å½“å‰é¡¹ç›®æ‰€éœ€è¦çš„å„ç§æ¨¡å—ï¼Œä»¥åŠé¡¹ç›®çš„é…ç½®ä¿¡æ¯ã€‚æ¯”å¦‚é¡¹ç›®åç§°ã€é¡¹ç›®ç‰ˆæœ¬ã€é¡¹ç›®æ‰§è¡Œå…¥å£æ–‡ä»¶ã€æ‰§è¡Œçš„è„šæœ¬ã€ä¾èµ–çš„æ’ä»¶ã€é¡¹ç›®è´¡çŒ®è€…ã€è®¸å¯è¯ä»¥åŠè¿è¡Œã€å¼€å‘ä»¥åŠæœ‰é€‰æ‹©åœ°å°†é¡¹ç›®å‘å¸ƒåˆ° npm æ‰€éœ€çš„ä¿¡æ¯ã€‚

### åˆ›å»ºpackage.jsonæ–‡ä»¶

```bash
npm init # æ ¹æ®æç¤ºåˆ›å»ºpackage.jsonæ–‡ä»¶
npm init -y # è·³è¿‡æ‰€æœ‰é—®é¢˜ï¼Œä½¿ç”¨é»˜è®¤å€¼åˆ›å»ºpackage.jsonæ–‡ä»¶
```

### package.jsonå†…å®¹

```json
{
  "name": "npmtest",  // å¿…é¡», é¡¹ç›®/æ¨¡å—çš„åç§°ã€‚é•¿åº¦å¿…é¡»å°äºç­‰äº214ä¸ªå­—ç¬¦ï¼Œä¸èƒ½ä»¥ç‚¹æˆ–ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¸èƒ½åŒ…å«å¤§å†™å­—æ¯
  "version": "1.0.0", // å¿…é¡»ï¼Œç‰ˆæœ¬å·
  /** å¯é€‰ */
  "description": "", // æè¿°ä¿¡æ¯ï¼Œä¾¿äºæœç´¢
  "main": "index.js", // å…¥å£æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯index.jsï¼Œrequire(â€˜moduleNameâ€™) å°±ä¼šåŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªå­—æ®µçš„é»˜è®¤å€¼æ˜¯æ¨¡å—æ ¹ç›®å½•ä¸‹é¢çš„ index.js
  // æ”¯æŒçš„è„šæœ¬å‘½ä»¤
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "xqhero <18810255996@163.com>", // ä½œè€…ä¿¡æ¯, å®ƒçš„å€¼æ˜¯ä½ åœ¨npmjs.orgç½‘ç«™çš„æœ‰æ•ˆè´¦æˆ·åï¼Œéµå¾ªâ€œè´¦æˆ·å<é‚®ä»¶>â€çš„è§„åˆ™
  "license": "ISC", 
  // å…³é”®è¯ï¼Œæœ‰åŠ©äºnpm searchæŸ¥æ‰¾åˆ°ä½ çš„é¡¹ç›®
  "keywords": [
    "vue"
  ], 
  // files å­—æ®µç”¨äºæè¿°æˆ‘ä»¬ä½¿ç”¨ npm publish å‘½ä»¤åæ¨é€åˆ° npm æœåŠ¡å™¨çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¦‚æœæŒ‡å®šæ–‡ä»¶å¤¹ï¼Œåˆ™æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šåŒ…å«è¿›æ¥ã€‚
  "files": [
    "index.js",
    "index.mjs",
    "dist"
  ],
  // å†…éƒ¨å‘½ä»¤å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨å®‰è£…æ—¶ï¼Œnpm ä¼šå°†æ–‡ä»¶è½¯é“¾æ¥/ç¬¦å·è¿æ¥åˆ° prefix/bin ä»¥è¿›è¡Œå…¨å±€å®‰è£…æˆ–./node_modules/.bin/æœ¬åœ°å®‰è£…ã€‚
  "bin": {
    "test": "./bin/test.js"
  },
  // æŒ‡å®šé¡¹ç›® node ç‰ˆæœ¬, engineså±æ€§ä»…èµ·åˆ°ä¸€ä¸ªè¯´æ˜çš„ä½œç”¨ï¼Œå½“ç”¨æˆ·ç‰ˆæœ¬ä¸ç¬¦åˆæŒ‡å®šå€¼æ—¶ä¹Ÿä¸å½±å“ä¾èµ–çš„å®‰è£…
   "engines": {
    "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
  },
  // bugæäº¤åœ°å€
  "bugs": {
    "url": "https://github.com/vuejs/core/issues"
  },
  // é¡¹ç›®ä¸»é¡µé“¾æ¥
  "homepage": "https://github.com/vuejs/core/tree/main/packages/vue#readme",
  // é¡¹ç›®ä»“åº“åœ°å€
  "repository": {
    "type": "git",
    "url": "git+https://github.com/vuejs/core.git"
  },
  // åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éœ€è¦ç”¨åˆ°çš„ä¾èµ–
  "dependencies": {
    "vue": "^3.3.8"
  },
  // åœ¨å¼€å‘ã€æµ‹è¯•ç¯å¢ƒä¸­ç”¨åˆ°çš„ä¾èµ–
  "devDependencies": {
    "jquery": "^3.7.1"
  }
}
```

#### è®¾ç½®npm init é»˜è®¤å€¼

```bash
#è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä¸ºnpm init è®¾ç½®é»˜è®¤å€¼
npm set init-author-name 'xqhero'
npm set init-author-email '18810255996@163.com'
npm set init-author-url 'https://www.xqhero.com'
npm set init-license 'MIT'
```

#### version ç‰ˆæœ¬å·è¯­ä¹‰è§„åˆ™

npmåŒ…æä¾›è€…éœ€è¦äº†è§£npmè§„åˆ™ï¼Œåº”è¯¥æ³¨æ„ç‰ˆæœ¬è§„èŒƒã€‚npm åŒ…ä¸­çš„æ¨¡å—ç‰ˆæœ¬éƒ½éœ€è¦éµå¾ª SemVer è§„èŒƒï¼Œè¯¥è§„èŒƒçš„æ ‡å‡†ç‰ˆæœ¬å·é‡‡ç”¨ X.Y.Z çš„æ ¼å¼ï¼Œå…¶ä¸­ Xã€Y å’Œ Z å‡ä¸ºéè´Ÿçš„æ•´æ•°ï¼Œä¸”ç¦æ­¢åœ¨æ•°å­—å‰æ–¹è¡¥é›¶ï¼š

- X æ˜¯ä¸»ç‰ˆæœ¬å·(major)ï¼šç¬¬ä¸€ä½å°±æ˜¯ä¸»è¦ç‰ˆæœ¬å·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé‡å¤§åŠŸèƒ½çš„æ›´æ–°ï¼Œæˆ–åŠŸèƒ½çš„æ·»åŠ åˆä¸èƒ½å‘åå…¼å®¹çš„æƒ…å†µä¼šæå‡è¯¥ç‰ˆæœ¬å·ã€‚å¦‚ï¼š2.0.0
- Y æ˜¯æ¬¡ç‰ˆæœ¬å·(minor)ï¼šä¸­é—´é‚£ä¸€ä½æ˜¯æŒ‡æ¬¡è¦ç‰ˆæœ¬å·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸€äº›åŠŸèƒ½çš„æ·»åŠ ï¼Œä½†åˆèƒ½å‘åå…¼å®¹ï¼Œè¿™ç§æ›´æ–°ä¼šæå‡è¯¥ç‰ˆæœ¬å·ã€‚å¦‚ï¼š1.1.0
- Z æ˜¯ä¿®è®¢å·(patch)ï¼šæœ€åä¸€ä½å°±æ˜¯è¡¥ä¸ç‰ˆæœ¬å·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæ˜¯é¡¹ç›®çš„ä¸€äº›BUGä¿®å¤ï¼Œä¼šå°†è¯¥ç‰ˆæœ¬å·æå‡ã€‚å¦‚ï¼š1.0.1

![version](/tools/02npm-4.png)

å½“æŸä¸ªç‰ˆæœ¬æ”¹åŠ¨æ¯”è¾ƒå¤§ã€å¹¶éç¨³å®šè€Œä¸”å¯èƒ½æ— æ³•æ»¡è¶³é¢„æœŸçš„å…¼å®¹æ€§éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½è¦å…ˆå‘å¸ƒä¸€ä¸ªå…ˆè¡Œç‰ˆæœ¬ã€‚å…ˆè¡Œç‰ˆæœ¬å·å¯ä»¥åŠ åˆ°ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·çš„åé¢ï¼Œé€šè¿‡ `-` å·è¿æ¥ä»¥å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦å’Œç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯ï¼š

- å†…éƒ¨ç‰ˆæœ¬(alpha)
- å…¬æµ‹ç‰ˆæœ¬(beta)
- æ­£å¼ç‰ˆæœ¬çš„å€™é€‰ç‰ˆæœ¬rcï¼ˆå³ Release candiateï¼‰, å¦‚ `2.0.0-rc.0`

Semantic Versioning ä¼šç”¨åˆ°å¦‚ä¸‹ç¬¦å·ï¼š

- `^`: ä¸æ¥å—æœ€å·¦è¾¹éé›¶æ•°å­—è¾ƒå¤§çš„ç‰ˆæœ¬
  - `^0.13.0` -> `npm update` -> `0.13.1`, ä¸ä¼šæ›´æ–°åˆ°`0.14.0`
  - `^1.13.0` -> `npm update` -> `1.13.1` / `1.14.0`, ä¸ä¼šæ›´æ–°åˆ°`2.0.0`
- `~`: åªæ¥æ”¶ä¿®è®¢å·è¾ƒå¤§çš„ç‰ˆæœ¬
- `>`: åªæ¥å—è¾ƒå¤§çš„ç‰ˆæœ¬ï¼Œç±»ä¼¼çš„è¿˜æœ‰`>=`ã€`<`ã€`<=`ã€`=`
- `-`: åªæ¥å—ä¸€å®šèŒƒå›´å†…çš„ç‰ˆæœ¬, å¦‚`2.1.0 - 2.6.2`
- `||`: åªæ¥å—ç»„åˆå†…çš„ç‰ˆæœ¬,å¦‚ `< 2.3 || > 2.6`

æœ€æ–°ç‰ˆæœ¬å¯ä»¥ç”¨`@latest`è¡¨ç¤ºã€‚

å…·ä½“å‚è€ƒï¼š[è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ SemVer](https://semver.org/lang/zh-CN/)

#### dependencies ä¸ devDependencies

devDependencies èŠ‚ç‚¹ä¸‹çš„æ¨¡å—æ˜¯æˆ‘ä»¬åœ¨å¼€å‘æ—¶éœ€è¦ç”¨çš„ï¼Œæ¯”å¦‚é¡¹ç›®ä¸­ä½¿ç”¨çš„ gulp ï¼Œå‹ç¼©cssã€jsçš„æ¨¡å—ã€‚è¿™äº›æ¨¡å—åœ¨æˆ‘ä»¬çš„é¡¹ç›®éƒ¨ç½²åæ˜¯ä¸éœ€è¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ -save-dev çš„å½¢å¼å®‰è£…ã€‚åƒ express è¿™äº›æ¨¡å—æ˜¯é¡¹ç›®è¿è¡Œå¿…å¤‡çš„ï¼Œåº”è¯¥å®‰è£…åœ¨ dependencies èŠ‚ç‚¹ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ -save çš„å½¢å¼å®‰è£…ã€‚



### package-lock.json æ–‡ä»¶

- package-lock.json æ–‡ä»¶æ˜¯ä¸€ä¸ªé”å®šæ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†ä½ çš„é¡¹ç›®å®‰è£…çš„æ‰€æœ‰ä¾èµ–åŒ…çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å®ƒä»¬çš„ç¡®åˆ‡ç‰ˆæœ¬å·ã€æ¥æºã€æ ¡éªŒå€¼ç­‰ã€‚
- å®ƒçš„ä½œç”¨æ˜¯è®©ä¸åŒçš„å¼€å‘è€…åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸Šèƒ½å¤Ÿå®‰è£…ç›¸åŒçš„ä¾èµ–åŒ…ï¼Œå³ä½¿è¿™äº›åŒ…å·²ç»å‘å¸ƒäº†æ–°çš„ç‰ˆæœ¬ã€‚
- package-lock.json æ–‡ä»¶æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå½“ä½ ä½¿ç”¨ npm ä¿®æ”¹äº† node_modules ç›®å½•æˆ–è€… package.json æ–‡ä»¶æ—¶ï¼Œå®ƒå°±ä¼šæ›´æ–°ã€‚

å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ npm i æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª package-lock.json æ–‡ä»¶ï¼Œå’Œ package.json åœ¨åŒä¸€çº§ç›®å½•ä¸‹ã€‚package-lock.json è®°å½•äº†é¡¹ç›®ä¾èµ–åŒ…çš„ä¿¡æ¯ã€‚å½“æˆ‘ä»¬ä¸‹æ¬¡å† npm i æ—¶ï¼Œnpm å‘ç°é¡¹ç›®ä¸­æœ‰ package-lock.json æ–‡ä»¶ï¼Œä¼šç›´æ¥æ ¹æ® package-lock.json é‡Œçš„å†…å®¹æ¥å¤„ç†å’Œå®‰è£…ä¾èµ–ï¼Œè€Œå¿½ç•¥ package.jsonã€‚

## node_modules æ¨¡å—ç®¡ç†

node_modulesæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾é¡¹ç›®æ‰€ä¾èµ–çš„npmåŒ…åŠå…¶ç›¸å…³ä¾èµ–ï¼Œä»¥ä¾›åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ‰€éœ€çš„æ¨¡å—å’Œåº“æ–‡ä»¶ã€‚æ¯”å¦‚webpackã€gulpã€gruntè¿™äº›å·¥å…·ã€‚ä½¿ç”¨npmå®‰è£…npmåŒ…æ—¶ï¼Œä¼šå°†ç›¸å…³ä¾èµ–åŒ…ä¸‹è½½å¹¶ä¿å­˜åœ¨é¡¹ç›®çš„node_modulesç›®å½•ä¸‹ï¼Œä»¥ä¾¿äºåœ¨åº”ç”¨ç¨‹åºä¸­å¼•ç”¨å’Œä½¿ç”¨è¿™äº›åŒ…ã€‚

### node_modules å±‚çº§

#### npm v1/v2 ä¾èµ–åµŒå¥—

npmæœ€æ—©çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†å¾ˆç®€å•çš„åµŒå¥—æ¨¡å¼è¿›è¡Œä¾èµ–ç®¡ç†ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä¾èµ–äº†Aæ¨¡å—ã€Bæ¨¡å—ã€Cæ¨¡å—ï¼Œè€ŒAã€Bã€Cæ¨¡å—ä¾èµ–äº†ä¸åŒç‰ˆæœ¬çš„Dæ¨¡å—ï¼Œæ­¤æ—¶ç”Ÿæˆçš„node_modulesç›®å½•å¦‚ä¸‹ï¼š

```
 â”œâ”€â”€ node_modules
    â”‚   â”œâ”€â”€ A@1.0.0
    â”‚   â”‚   â””â”€â”€ node_modules
    â”‚   â”‚   â”‚   â””â”€â”€ D@1.0.0
    â”‚   â”œâ”€â”€ B@1.0.0
    â”‚   â”‚   â””â”€â”€ node_modules
    â”‚   â”‚   â”‚   â””â”€â”€ D@2.0.0
    â”‚   â””â”€â”€ C@1.0.0
    â”‚   â”‚   â””â”€â”€ node_modules
    â”‚   â”‚   â”‚   â””â”€â”€ D@1.0.0
```

::: warning ä¾èµ–åœ°ç‹±
æ¯ä¸ªæ¨¡å—çš„ä¾èµ–ä¸‹é¢éƒ½ä¼šå­˜åœ¨ä¸€ä¸ª node_modules ç›®å½•æ¥å­˜æ”¾æ¨¡å—ä¾èµ–çš„ä¾èµ–ã€‚å¦‚æœä¾èµ–éå¸¸å¤šï¼Œä¸åŒæ¨¡å—ä¸‹ç›¸åŒçš„ä¾èµ–ä¼šè¢«é‡å¤å®‰è£…ï¼Œé€ æˆç©ºé—´çš„æµªè´¹ï¼Œæœ€ç»ˆnode_moduleså ªæ¯”é»‘æ´ï¼Œå¾ˆå¿«å°±ä¼šå æ»¡åˆºå•Šç›¼ã€‚è€Œä¸”ä¾èµ–åµŒå¥—çš„æ·±åº¦ä¹Ÿä¼šååˆ†å¯æ€•ï¼Œè¿™å°±æ˜¯ä¾èµ–åœ°ç‹±ã€‚
:::

#### npm v3 æ‰å¹³ç»“æ„

ä¸ºäº†å°†åµŒå¥—çš„ä¾èµ–å°½é‡æ‰“å¹³ï¼Œé¿å…è¿‡æ·±çš„ä¾èµ–æ ‘å’ŒåŒ…å†—ä½™ï¼Œnpm v3 å°†å­ä¾èµ–ã€Œæå‡ã€(hoist)ï¼Œé‡‡ç”¨æ‰å¹³çš„ node_modules ç»“æ„ï¼Œå­ä¾èµ–ä¼šå°½é‡å¹³é“ºå®‰è£…åœ¨ä¸»ä¾èµ–é¡¹æ‰€åœ¨çš„ç›®å½•ä¸­ã€‚

```
 â”œâ”€â”€ node_modules
    â”‚   â”œâ”€â”€ A@1.0.0
    â”‚   â”œâ”€â”€ B@1.0.0
    â”‚   â”‚   â””â”€â”€ node_modules
    â”‚   â”‚   â”‚   â””â”€â”€ D@2.0.0
    â”‚   â””â”€â”€ C@1.0.0
    â”‚   â””â”€â”€ D@1.0.0
```

ä¸ºäº†ç¡®ä¿æ¨¡å—çš„æ­£ç¡®åŠ è½½ï¼Œnpmä¹Ÿå®ç°äº†é¢å¤–çš„`ä¾èµ–æŸ¥æ‰¾`ç®—æ³•ï¼Œæ ¸å¿ƒæ˜¯`é€’å½’å‘ä¸ŠæŸ¥æ‰¾node_modules`ã€‚åœ¨å®‰è£…æ–°çš„åŒ…æ—¶ï¼Œä¼šä¸åœå¾€ä¸Šçº§node_modulesä¸­æŸ¥æ‰¾ã€‚å¦‚æœæ‰¾åˆ°ç›¸åŒç‰ˆæœ¬çš„åŒ…å°±ä¸ä¼šé‡æ–°å®‰è£…ï¼Œåœ¨é‡åˆ°ç‰ˆæœ¬å†²çªæ—¶æ‰ä¼šåœ¨æ¨¡å—ä¸‹çš„ node_modules ç›®å½•ä¸‹å­˜æ”¾è¯¥æ¨¡å—å­ä¾èµ–ï¼Œè§£å†³äº†å¤§é‡åŒ…é‡å¤å®‰è£…çš„é—®é¢˜ï¼Œä¾èµ–çš„å±‚çº§ä¹Ÿä¸ä¼šå¤ªæ·±ã€‚

æ‰å¹³åŒ–çš„æ¨¡å¼è§£å†³äº†ä¾èµ–åœ°ç‹±çš„é—®é¢˜ï¼Œä½†ä¹Ÿå¸¦æ¥äº†é¢å¤–çš„æ–°é—®é¢˜ï¼š

- å¹½çµä¾èµ–ï¼ˆPhantom dependencyï¼‰ï¼šå‘ç”ŸæŸä¸ªåŒ…æœªåœ¨package.jsonä¸­å®šä¹‰ï¼Œä½†é¡¹ç›®ä¸­ä¾ç„¶å¯ä»¥å¼•ç”¨åˆ°çš„æƒ…å†µä¸‹ã€‚

::: theorem å¹½çµä¾èµ–

package.jsonä¸­ä¸å­˜åœ¨å´å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ä¾èµ–å°±æ˜¯å¹½çµä¾èµ–ã€‚ åœ¨ä¾èµ–æ‰å¹³åŒ–åï¼Œè¢«æå‡çš„ä¾èµ–å°±æ˜¯å¹½çµä¾èµ–ã€‚

```
node_modules
â”œâ”€ A
â””â”€ C@1.0.0
```

å¦‚ä¸Šç»“æ„ï¼ŒC@1.0.0å°±æ˜¯å¹½çµä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨C@1.0.0,ä½†æ˜¯package.jsonä¸­å¹¶æ²¡æœ‰è¿™ä¸ªä¾èµ–é¡¹ã€‚å¦‚æœæœ‰äººå‘ç°ä¾èµ– A ä¸å†ä½¿ç”¨ï¼Œäºæ˜¯åˆ é™¤äº† Aã€‚ä½†æ˜¯å¹½çµä¾èµ–C@1.0.0ä¾ç„¶åœ¨é¡¹ç›®è¢«ä½¿ç”¨ç€ï¼Œè¿™å°±ä¼šå¼•èµ·æŠ¥é”™ã€‚
:::

- å¤šé‡ä¾èµ–ï¼ˆdoppelgangersï¼‰

::: theorem å¤šé‡ä¾èµ– / åˆ†èº«ä¾èµ–

å¤šä¸ªæ¨¡ç‰ˆä¾èµ–åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œå¯¼è‡´æ‰å¹³åŒ–æ—¶åªèƒ½å°†ä¸€ä¸ªç‰ˆæœ¬çš„åŒ…æå‡åˆ°node_modulesæ ¹ç›®å½•ï¼Œè€Œå…¶ä»–ç‰ˆæœ¬åœ¨å¯¹åº”çš„æ¨¡å—ä¸‹é‡å¤å®‰è£…ã€‚

```
node_modules
â”œâ”€ A
â”œâ”€ C@1.0.0
â”œâ”€ D
â”œâ”€ B
â”‚  â””â”€ node_modules
â”‚     â””â”€ C@2.0.0
â”‚â”€ E
â”‚  â””â”€ node_modules
â””â”€    â””â”€ C@2.0.0
```
å¦‚ä¸Šç»“æ„æ‰€ç¤ºï¼ŒC@2.0.0è¢«é‡å¤å®‰è£…ï¼Œå› æ­¤C@2.0.0è¢«å«åšåˆ†èº«ä¾èµ–ã€‚
:::

- ä¸ç¡®å®šæ€§ï¼ˆNon-Determinismï¼‰ï¼šnode_modulesç›®å½•ä»¥åŠä¾èµ–æ ‘ç»“æ„å–å†³äºç”¨æˆ·å®‰è£…çš„é¡ºåºã€‚

::: theorem ä¸ç¡®å®šæ€§

å‡å¦‚Aä¾èµ–äºC@1.0.0, Bä¾èµ–äºC@2.0.0ã€‚é‚£ä¹ˆä¾èµ–å®‰è£…ä¼šæå‡çš„æ˜¯C@1.0.0è¿˜æ˜¯C@2.0.0å‘¢ï¼Ÿä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸¤ç§ç»“æ„ï¼š

```
node_modules
â”œâ”€ A
â”œâ”€ B
â”‚  â””â”€ node_modules
â”‚    â””â”€ C@2.0.0
â””â”€ C@1.0.0
```

è¿˜æ˜¯

```
node_modules
â”œâ”€ A
â”‚  â””â”€ node_modules
â”‚     â””â”€ C@1.0.0
â”œâ”€ B
â””â”€ C@2.0.0
```
:::


#### npm v5 æ‰å¹³åŒ– + lock

åœ¨npm v5ä¸­æ–°å¢äº†package-lock.jsonã€‚å½“é¡¹ç›®æœ‰package.jsonæ–‡ä»¶å¹¶é¦–æ¬¡æ‰§è¡Œnpm installå®‰è£…åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªpackage-lock.jsonæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶é‡Œé¢è®°å½•äº†package.jsonä¾èµ–çš„æ¨¡å—ï¼Œä»¥åŠæ¨¡å—çš„å­ä¾èµ–ã€‚å¹¶ä¸”ç»™æ¯ä¸ªä¾èµ–æ ‡æ˜äº†ç‰ˆæœ¬ã€è·å–åœ°å€å’ŒéªŒè¯æ¨¡å—å®Œæ•´æ€§å“ˆå¸Œå€¼ã€‚é€šè¿‡package-lock.jsonï¼Œä¿éšœäº†ä¾èµ–åŒ…å®‰è£…çš„ç¡®å®šæ€§ä¸å…¼å®¹æ€§ï¼Œä½¿å¾—æ¯æ¬¡å®‰è£…éƒ½ä¼šå‡ºç°ç›¸åŒçš„ç»“æœã€‚

### node_modules/.binç›®å½•

è¯¥ç›®å½•ä¿å­˜ä¾èµ–ç›®å½•ä¸­æ‰€å®‰è£…çš„å¯ä¾›è°ƒç”¨çš„å‘½ä»¤è¡ŒåŒ…ã€‚æœ¬è´¨æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶åˆ°æŒ‡å®šæ–‡ä»¶æºçš„æ˜ å°„ã€‚ä¾‹å¦‚ webpack å°±å±äºä¸€ä¸ªå‘½ä»¤è¡ŒåŒ…ã€‚å¦‚æœæˆ‘ä»¬åœ¨å®‰è£… webpack æ—¶æ·»åŠ  --global å‚æ•°ï¼Œå°±å¯ä»¥åœ¨ç»ˆç«¯ç›´æ¥è¾“å…¥ webpack è¿›è¡Œè°ƒç”¨ã€‚

npm run å‘½ä»¤åœ¨æ‰§è¡Œæ—¶ä¼šæŠŠ ./node_modules/.bin åŠ å…¥åˆ° PATH ä¸­ï¼Œä½¿æˆ‘ä»¬å¯ç›´æ¥è°ƒç”¨æ‰€æœ‰æä¾›äº†å‘½ä»¤è¡Œè°ƒç”¨æ¥å£çš„ä¾èµ–åŒ…ã€‚

æ¯”å¦‚ä»£ç æ£€æµ‹å·¥å…· ESLintï¼š

```bash
# å®‰è£…ä»£ç æ£€æµ‹å·¥å…·
> npm install eslint --save-dev

# node_modules/.bin ç»“æ„
> /node_modules/.bin/ ls -l
total 0
lrwxr-xr-x  1 guoqiangzhou  staff  18 11 21 17:03 acorn -> ../acorn/bin/acorn
lrwxr-xr-x  1 guoqiangzhou  staff  23 11 21 17:03 eslint -> ../eslint/bin/eslint.js
lrwxr-xr-x  1 guoqiangzhou  staff  25 11 21 17:03 js-yaml -> ../js-yaml/bin/js-yaml.js
lrwxr-xr-x  1 guoqiangzhou  staff  23 11 21 17:03 node-which -> ../which/bin/node-which
lrwxr-xr-x  1 guoqiangzhou  staff  16 11 21 17:03 rimraf -> ../rimraf/bin.js
ï£¿ ~/Work/javascript/p/node_modules/.bin/ vim ../eslint/bin/eslint.js  

# æ‰§è¡Œ
> ./node_modules/.bin/eslint --init
> ./node_modules/.bin/eslint yourfile.js
```

 npm ä»5.2 å¼€å§‹è‡ªå¸¦äº†ä¸€ä¸ªæ–°çš„å·¥å…· npxã€‚ npxå¯ä»¥ç›´æ¥æ‰§è¡Œ node_modules/.bin æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚åœ¨è¿è¡Œå‘½ä»¤æ—¶ï¼Œnpx å¯ä»¥è‡ªåŠ¨å» node_modules/.bin è·¯å¾„å’Œç¯å¢ƒå˜é‡ $PATH é‡Œé¢æ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸éœ€è¦å†åœ¨ package.json ä¸­å®šä¹‰ç›¸å…³çš„ scriptã€‚

```
npx eslint --init
npx eslint yourfile.js
```

## npm æ‰§è¡ŒåŸç†

### npm install æ‰§è¡Œè¿‡ç¨‹

![npm installè¿‡ç¨‹](/tools/02npm-2.png)

- npm é¦–å…ˆä¼šæ£€ç´¢é…ç½®ï¼Œæ­¤å¤„åˆ†ä¸º3ä¸ªæ­¥éª¤ï¼š
  - æ£€ç´¢ .npmrc é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®æ£€ç´¢åˆ°çš„é…ç½®ç»§ç»­å»æ‰§è¡Œå‘½ä»¤ã€‚è¯¥æ–‡ä»¶çš„å†…å®¹ä¸€èˆ¬æ˜¯è®¾ç½®é•œåƒæºã€ç¼“å­˜è·¯å¾„ä»¥åŠå‰ç½®è·¯å¾„ã€‚
  - æ£€ç´¢é¡¹ç›®ä¸­æ˜¯å¦æœ‰ package.json é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰åˆ™æŠ¥ Error ï¼Œæç¤ºå¼€å‘è€…æœªåˆå§‹åŒ–é¡¹ç›®ï¼›
  - è‹¥æœ‰ package.json é…ç½®æ–‡ä»¶ï¼Œç»§ç»­æ£€ç´¢æ˜¯å¦æœ‰ package-lock.json é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®ä¸Šé¢æµç¨‹å›¾çš„åˆ¤æ–­æ­¥éª¤æ‰§è¡Œã€‚
- æ ¹æ®æ£€ç´¢å¾—å‡ºçš„ç»“æœï¼Œå†³å®šæ ¹æ®å“ªä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–åŒ…ä¿¡æ¯å»å¤„ç†èµ„æºï¼›
- æœ‰ç»Ÿä¸€çš„ä¾èµ–åŒ…ä¿¡æ¯ä¹‹åï¼Œå¼€å§‹å¤„ç†èµ„æºã€‚å¤„ç†èµ„æºæ—¶éœ€è¦æ£€æŸ¥ä¾èµ–åŒ…çš„ç¼“å­˜ï¼Œæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ä¸‹è½½ä¾èµ–åŒ…èµ„æºï¼›
- å¤„ç†å®Œä¾èµ–åŒ…èµ„æºä¹‹åï¼Œç”Ÿæˆæˆ–æ›´æ–° package-lock.json é…ç½®æ–‡ä»¶ã€‚

### npm run xxx è¾“å…¥åˆ°æ‰§è¡Œå‘ç”Ÿäº†ä»€ä¹ˆ

npm åœ¨æ‰§è¡Œinstallçš„æ—¶å€™ï¼Œä¼šæ ¹æ®ç¬¬ä¸‰æ–¹ä¾èµ–ä¸­çš„package.jsoné‡Œé¢çš„biné…ç½®ï¼Œåœ¨node_modulesä¸‹é¢çš„.binç›®å½•ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å…¶å®æ˜¯ä¸€ä¸ªæ›¿èº«æ–‡ä»¶ï¼ˆè½¯é“¾æ¥æ–‡ä»¶ï¼‰ï¼Œè¿™ä¸ªæ›¿èº«æ–‡ä»¶çœŸæ­£æŒ‡å‘çš„å°±æ˜¯ç¬¬ä¸‰æ–¹ä¾èµ–package.jsoné‡Œé¢çš„biné…ç½®æŒ‡å‘çš„é‚£ä¸ªæ–‡ä»¶ã€‚

npmè¿è¡Œscriptè„šæœ¬æ—¶ä¼šå°†å½“å‰é¡¹ç›®çš„å¯æ‰§è¡Œä¾èµ–ç›®å½•ï¼ˆå³node_modules/.binï¼‰æ·»åŠ åˆ°ç¯å¢ƒå˜é‡pathä¸­ï¼Œå½“æ‰§è¡Œä¹‹åä¹‹åå†æ¢å¤åŸæ ·ã€‚å°±æ˜¯è¯´è„šæœ¬å‘½ä»¤ä¸­çš„ä¾èµ–åä¼šç›´æ¥æ‰¾åˆ°node_modules/.binä¸‹é¢çš„å¯¹åº”è„šæœ¬ï¼Œè€Œä¸éœ€è¦åŠ ä¸Šè·¯å¾„ã€‚

å¦‚ä¸‹å›¾ï¼Œä»¥vite/vueé¡¹ç›®ä¸ºä¾‹ï¼Œæ‰§è¡Œnpm run devçš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š

![npm runè¿‡ç¨‹](/tools/02npm-3.png)

::: warning æç¤º
æ‰§è¡Œ npm run xxx æ—¶ï¼Œè‹¥å½“å‰ç›®å½•çš„ node_modules/.bin æŸ¥æ‰¾ä¸åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ™ä¼šè¿”å›ä¸Šä¸€çº§ï¼Œå»å…¨å±€çš„ node_modules/.bin ä¸­æŸ¥æ‰¾ã€‚å¦‚æœå…¨å±€ç›®å½•è¿˜æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆ npm å°±ä¼šä»ç³»ç»Ÿç¯å¢ƒå˜é‡ path ä¸­æŸ¥æ‰¾ï¼Œæ‰¾å¾—åˆ°å°±ä¼šè¿è¡Œï¼Œå¦åˆ™æŠ¥é”™ã€‚
:::

#### æ‰§è¡Œé¡ºåº

ä¸€ä¸ªnpmè„šæœ¬å¯ä»¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ä¹‹é—´å¯ä»¥æŒ‡å®šä¸åŒçš„æ‰§è¡Œé¡ºåºã€‚

`&` å¹¶è¡Œæ‰§è¡Œé¡ºåºï¼ŒåŒæ—¶æ‰§è¡Œã€‚

```json
"dev":"node test.js & webpack"
```

&&ç»§å‘é¡ºåºï¼Œæ‰§è¡Œå‰é¢ä¹‹åæ‰å¯ä»¥æ‰§è¡Œåé¢ã€‚

```json
"dev":"node test.js && webpack"
```

#### é¡ºåºé’©å­

npmè„šæœ¬è‡ªå¸¦ä¸¤ä¸ªé¡ºåºé’©å­ï¼ŒÂ `pre`å’Œ `post`:

```json
"predev":"node test_one.js",
"dev":"node test_two.js",
"postdev":"node test_three.js"
```

å½“æ‰§è¡Œ npm run dev çš„æ—¶å€™é»˜è®¤å°±ä¼šæ‰§è¡Œ: 

```bash
npm run predev && npm run dev && npm run postdev
```

#### è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬åç§°

npm æä¾›ä¸€ä¸ª`npm_lifecycle_event`å˜é‡ï¼Œè¿”å›å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬åç§°ï¼Œå¯ä»¥é…åˆé¡ºåºé’©å­ä½¿ç”¨:

```javascript
const target = process.env.npm_lifecycle_event;

if(target === 'predev'){
  console.log('the process is predev')  
}
if(target === 'dev'){
  console.log('the process is dev')
}
if(target === 'postdev'){
  console.log('this process is postdev')
}
```

#### ä½¿ç”¨package.jsonå†…éƒ¨å˜é‡

é€šè¿‡ `npm_package_`å‰ç¼€ï¼Œnpmè„šæœ¬å¯ä»¥æ‹¿åˆ°npmçš„å†…éƒ¨å˜é‡:

```javascript
console.log(process.env.npm_package_name) //aaaa
```

## npm å‘¨è¾¹å·¥å…·
### nrm ç®¡ç†npmæº

1. å…¨å±€å®‰è£…nrm

```bash
npm i nrm -g
```

2. æ£€æŸ¥nrmæ˜¯å¦å®‰è£…æˆåŠŸ

```bash
> nrm ls
  npm ---------- https://registry.npmjs.org/
  yarn --------- https://registry.yarnpkg.com/
  tencent ------ https://mirrors.cloud.tencent.com/npm/
  cnpm --------- https://r.cnpmjs.org/
* taobao ------- https://registry.npmmirror.com/
  npmMirror ---- https://skimdb.npmjs.com/registry/

> nrm current
You are using taobao registry.
```

3. åˆ‡æ¢npmæº

```bash
npm use cnpm
```

4. å¢åŠ æº

```bash
> nrm add bili http://registry.npm.bilibili.co/
> nrm ls
  npm ---------- https://registry.npmjs.org/
  yarn --------- https://registry.yarnpkg.com/
  tencent ------ https://mirrors.cloud.tencent.com/npm/
  cnpm --------- https://r.cnpmjs.org/
* taobao ------- https://registry.npmmirror.com/
  npmMirror ---- https://skimdb.npmjs.com/registry/
  bili --------- http://registry.npm.bilibili.co/
```

5. å…¶ä»–

```bash
nrm test npm  # æµ‹è¯•é€Ÿåº¦
nrm del  taobao #åˆ é™¤å¯¹åº”çš„æº
```

### nvm  / n ç‰ˆæœ¬ç®¡ç†

nvmï¼ˆNode Version Managerï¼‰æ˜¯ Node.js ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åœ¨åŒä¸€å°æœºå™¨ä¸Šå®‰è£…ã€ç®¡ç†å¤šä¸ª Node.js ç‰ˆæœ¬ã€‚ç”±äºä¸åŒçš„é¡¹ç›®å¯èƒ½éœ€è¦ä½¿ç”¨ä¸åŒçš„ Node.js ç‰ˆæœ¬ï¼Œnvm å¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿåœ°åœ¨ä¸åŒçš„ Node.js ç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ï¼Œé¿å…ç‰ˆæœ¬å†²çªçš„é—®é¢˜ã€‚

nvm å¸¸ç”¨å‘½ä»¤: 

```
nvm install ## å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼Œå¯æ¨¡ç³Šå®‰è£…ï¼Œå¦‚ï¼šå®‰è£…v6.2.0ï¼Œæ—¢å¯nvm install v6.2.0ï¼Œåˆå¯nvm install 6.2
nvm uninstall ## åˆ é™¤å·²å®‰è£…çš„æŒ‡å®šç‰ˆæœ¬ï¼Œè¯­æ³•ä¸installç±»ä¼¼
nvm use ## åˆ‡æ¢ä½¿ç”¨æŒ‡å®šçš„ç‰ˆæœ¬node
nvm ls ## åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„ç‰ˆæœ¬
nvm ls-remote ## åˆ—å‡ºæ‰€ä»¥è¿œç¨‹æœåŠ¡å™¨çš„ç‰ˆæœ¬ï¼ˆå®˜æ–¹node version listï¼‰
nvm current ## æ˜¾ç¤ºå½“å‰çš„ç‰ˆæœ¬
nvm alias ## ç»™ä¸åŒçš„ç‰ˆæœ¬å·æ·»åŠ åˆ«å
nvm unalias ## åˆ é™¤å·²å®šä¹‰çš„åˆ«å
nvm reinstall-packages ## åœ¨å½“å‰ç‰ˆæœ¬nodeç¯å¢ƒä¸‹ï¼Œé‡æ–°å…¨å±€å®‰è£…æŒ‡å®šç‰ˆæœ¬å·çš„npmåŒ…
```

næ˜¯nodeä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†å’Œåˆ‡æ¢nodeç‰ˆæœ¬ï¼Œå…¶ä½œè€…æ˜¯TJ Holowaychukï¼ˆå‡ºåçš„Expressæ¡†æ¶ä½œè€…ï¼‰ï¼Œä½¿ç”¨éå¸¸ä¹‹ç®€å•ã€‚å¸¸ç”¨å‘½ä»¤:

```
npm install -g n
n //æŸ¥çœ‹å·²å®‰è£…ç‰ˆæœ¬
n latest  //å®‰è£…æœ€æ–°ç‰ˆæœ¬å¹¶ä½¿ç”¨
n latest -d   //ä¸‹è½½æœ€æ–°ç‰ˆä½†ä¸ä½¿ç”¨ï¼Œ-då‚æ•°è¡¨ç¤ºä¸ºä»…ä¸‹è½½
n stable  //å®‰è£…æœ€æ–°ç¨³å®šç‰ˆæœ¬å¹¶ä½¿ç”¨
n <version>  //å®‰è£…æŸä¸ªç‰ˆæœ¬å¹¶ä½¿ç”¨ï¼Œå¦‚$n 6.2.2
n rm <version ...> //åˆ é™¤æŸäº›ç‰ˆæœ¬
n ls    //æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬
n --latest    //æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬
n --stable    //æŸ¥çœ‹æœ€æ–°ç¨³å®šç‰ˆ
n -h    //æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ï¼Œæ›´å¤šå‘½ä»¤åœ¨è¿™é‡ŒæŸ¥çœ‹
```

## åˆ›å»ºå’Œå‘å¸ƒNPMåŒ…

åˆ›å»ºå’Œå‘å¸ƒä¸€ä¸ªnpmåŒ…çš„æ­¥éª¤ï¼š
- æ³¨å†Œè´¦å· [å®˜ç½‘](https://www.npmjs.com/)
- åˆ›å»ºä¸€ä¸ªç»„ç»‡ï¼Œé˜²æ­¢æŠ¥åå†²çª
- åˆå§‹åŒ–
- ç¼–ç 
- æ‰“åŒ…
- æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- æäº¤è¿œç¨‹ä»“åº“(å¯é€‰)
- å‘å¸ƒ
- æ›´æ–°
- release-it è‡ªåŠ¨å‘å¸ƒ

ä¸‹é¢ä»¥Typescriptç¼–å†™å’Œå‘å¸ƒnpmåŒ…ä¸ºä¾‹ã€‚å®Œæ•´ä»£ç åœ°å€è§[è¿™é‡Œ](https://github.com/xqhero/xqhero-test-pkg)

### åˆ›å»ºç»„ç»‡

æå‰æŸ¥é˜…ä½ çš„é¡¹ç›®åç§°æ—¶å€™å·²ç»å­˜åœ¨ä¸€ä¸ªåŒ…ï¼Œå¦‚æœæœ‰çš„è¯è€ƒè™‘æ¢ä¸€ä¸ªå…¶ä»–çš„åŒ…åï¼Œæˆ–è€…ç›´æ¥åˆ›å»ºä¸€ä¸ªç»„ç»‡ï¼Œä»¥åæ‰€æœ‰çš„åŒ…éƒ½å‘å¸ƒåœ¨ç»„ç»‡ä¸‹ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æŠ¥åå†²çªçš„é—®é¢˜äº†ã€‚

![æ³¨å†Œç»„ç»‡](/tools/02npm-5.png)

åœ¨åç»­package.json ä¸­çš„ name å­—æ®µæ”¹ä¸º `scope` çš„æ ¼å¼ï¼Œæ¯”å¦‚åŸæ¥çš„ name æ˜¯ aï¼Œåˆ›å»ºäº†ä¸€ä¸ªç»„ç»‡ bï¼Œé‚£ä¹ˆè¿™æ—¶å€™ name åº”è¯¥ä¸º @b/aã€‚

### åˆå§‹åŒ–

- æ‰§è¡Œ npm initåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œæ ¹æ®æŒ‡å¼•å®Œæˆåˆ›å»ºï¼Œç”Ÿæˆpackage.jsonæ–‡ä»¶
- æ‰§è¡Œ git initæ¥åˆå§‹åŒ–gitä»“åº“ï¼Œæ·»åŠ README.mdã€.gitignoreæ–‡ä»¶ï¼Œåˆ›å»ºgithub/giteeä»“åº“å¹¶å…³è”
- ä¿®æ”¹pacakge.jsonæ–‡ä»¶
- å®‰è£…Typescriptä¾èµ–

```bash
> npm i typescript -D
> npx tsc --init # ç”Ÿæˆtsconfig.jsonæ–‡ä»¶
```

é…ç½®tsconfig.jsonï¼š

```json
{
  "compilerOptions": {
    "target": "es5", // æŒ‡å®šECMAScriptç›®æ ‡ç‰ˆæœ¬
    "module": "commonjs", // æŒ‡å®šæ¨¡å—åŒ–ç±»å‹
    "declaration": true, // ç”Ÿæˆ`.d.ts`ç±»å‹å£°æ˜æ–‡ä»¶
    "outDir": "./dist",// ç¼–è¯‘åç”Ÿæˆçš„æ–‡ä»¶ç›®å½•
    "strict": true // å¼€å¯ä¸¥æ ¼çš„ç±»å‹æ£€æµ‹
  }
}
```

### ç¼–ç 

åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºlibç›®å½•ï¼Œåœ¨libç›®å½•é‡Œæ–°å»ºindex.tsæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

```typescript
export function add(a: number, b: number) : number {
    return a + b;
}
```

### æ‰“åŒ…

å°†ç¼–è¯‘å‘½ä»¤å’Œå‘å¸ƒå‘½ä»¤æ·»åŠ åˆ°package.jsonæ–‡ä»¶ï¼Œä¿®æ”¹mainï¼Œå¢åŠ typesï¼Œæ”¹åŠ¨åçš„package.jsonæ–‡ä»¶å¦‚ä¸‹ï¼š

```json
{
  "name": "@xqherotools/test",
  "version": "1.0.3",
  "description": "npm package test",
  "main": "./dist/index.js",  // æŒ‡å®šå…¥å£æ–‡ä»¶
  "types": "./dist/index.d.ts", // æŒ‡å®štypesç±»å‹å£°æ˜æ–‡ä»¶
  // "type": "module", å¦‚æœåº“ä¼šä½œä¸ºESMä½¿ç”¨ï¼Œåˆ™éœ€è¦æ·»åŠ æ­¤è¡Œ
  "scripts": {
    "prepublish": "npm run build",  // è®¾ç½®å‘å¸ƒå‰ç½®é’©å­
    "test": "mocha --reporter spec", // æµ‹è¯•
    "build": "tsc", // build
    "release": "release-it"
  },
  // ä»“åº“åœ°å€
  "repository": {
    "type": "git",
    "url": "git+https://github.com/xqhero/xqhero-test-pkg.git"
  },
  "homepage": "https://github.com/xqhero/xqhero-test-pkg/blob/main/README.md",
  "author": "xqhero <18810255996@163.com>",
  "license": "MIT",
  "keywords": [
    "test"
  ],
  "devDependencies": {
    "@release-it/conventional-changelog": "^8.0.1",
    "chai": "^4.3.10",
    "mocha": "^10.2.0",
    "release-it": "^17.0.0",
    "typescript": "^5.3.2"
  }
}
```

è¿è¡Œå‘½ä»¤ï¼Œæ‰§è¡Œç¼–è¯‘å‘½ä»¤`npm run build`, æˆ‘ä»¬å¯ä»¥åœ¨ç›®å½•ä¸‹çœ‹åˆ°å‡ºç°äº†distç›®å½•ï¼Œåœ¨è¯¥ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªåŒ…å«ä»£ç é€»è¾‘çš„jsæ–‡ä»¶ï¼Œä¸€ä¸ªåŒ…å«ç±»å‹å®šä¹‰çš„interfaceæ–‡ä»¶ã€‚

![distç›®å½•](02npm-6.png)

### æµ‹è¯•

1. å®‰è£…æµ‹è¯•æ¡†æ¶å’Œæ–­è¨€åº“

```bash
npm i mocha -D
npm i chai -D
```

2. åˆ›å»ºæµ‹è¯•æ–‡ä»¶ç›®å½•å’Œæ–‡ä»¶

```bash
mkdir test && touch test.js
```

3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹

```javascript
"use strict";
const expect = require('chai').expect;
const add = require("../dist/index").add;

describe('xqhero-test function test', () => {
    it('should return 2', () => {
        const result = add(1,1)
        expect(result).to.equal(2);
    });
})
```

4. è¿è¡Œæµ‹è¯•

åœ¨package.jsonä¸­æ·»åŠ æµ‹è¯•å‘½ä»¤ï¼š

```json
{
  "scripts": {
    // ...
    "test": "mocha --reporter spec",
    // ...
  }
}
```
è¿è¡Œæµ‹è¯•è„šæœ¬ï¼š

```bash
> npm run test
> @xqherotools/test@1.0.3 test
> mocha --reporter spec



  xqhero-test function test
    âœ” should return 2


  1 passing (3ms)
```

### æäº¤è¿œç¨‹ä»“åº“

åœ¨.gitignoreæ–‡ä»¶ä¸­æ·»åŠ node_modules é¿å…å°†node_modules æ·»åŠ åˆ°ç‰ˆæœ¬æ§åˆ¶ä¸­; æ·»åŠ distç›®å½•ï¼Œç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä¸éœ€è¦æ·»åŠ ç‰ˆæœ¬æ§åˆ¶ä¸­

### å‘å¸ƒ

1. åœ¨å‘å¸ƒä»£ç å‰ï¼Œéœ€è¦å°†ä¸€äº›æ²¡æœ‰å¿…è¦çš„æ–‡ä»¶æˆ–ç›®å½•ä»å®‰è£…æ–‡ä»¶ä¸­æ’é™¤ï¼Œä¾‹å¦‚ libæ–‡ä»¶ç›®å½•ã€‚ ä¸¤ç§æ–¹å¼è¾¾æˆç›®æ ‡ã€‚

**æ–¹å¼1 åˆ›å»º.npmignoreæ–‡ä»¶æ’é™¤**

```bash
# æ’é™¤ libæ–‡ä»¶
lib/
tsconfig.json
```

**æ–¹å¼2 é€šè¿‡package.jsonä¸­fileså­—æ®µè®¾å®š**

```json
{
  // ...
  "files": [
    "dist",
    "LICENSE",
    "README.md",
    "package.json"
  ]
}

2. npmç™»å½•å’Œç¡®è®¤æºåœ°å€

ä½¿ç”¨npm loginå‘½ä»¤ç™»å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
> npm login
npm WARN adduser `adduser` will be split into `login` and `register` in a future version. `adduser` will become an alias of `register`. `login` (currently an alias) will become its own command.
npm notice Log in on https://registry.npmjs.org/
Username: xqhero  # å¡«å†™ç”¨æˆ·å
Password:   # å¡«å†™å¯†ç 
Email: (this IS public) 18810255996@163.COM  #å¡«å†™é‚®ç®±
npm notice Please check your email for a one-time password (OTP)
Enter one-time password: 84332841  #OTP
Logged in as xqhero on https://registry.npmjs.org/.
```

å› ä¸ºæˆ‘ä»¬è¦å‘å¸ƒåˆ°å®˜æ–¹æºä¸Šï¼Œæ‰€ä»¥è¦ç¡®ä¿æºåœ°å€ä¸ºå®˜æ–¹åœ°å€ https://registry.npmjs.com, ä¿®æ”¹registryæºå¯ä»¥æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š

- ä½¿ç”¨nrmåˆ‡æ¢æº
- åœ¨å½“å‰é¡¹ç›®é…ç½®ï¼Œæ·»åŠ .npmrcæ–‡ä»¶

```yaml
registry = https://registry.npmjs.com
```
- å‘å¸ƒåŒ…çš„æ—¶å€™æŒ‡å®š --registryé€‰é¡¹ï¼Œnpm publish --registry=https://registry.npmjs.com
- åœ¨å½“å‰é¡¹ç›®package.jsonä¸­é€šè¿‡publishConfigå­—æ®µæŒ‡å®š

```json
{
  "publicConfig": {
    "registry": "https://registry.npmjs.com"
  }
}
```

3. å‘å¸ƒç‰ˆæœ¬

é€šè¿‡npm publish å‘½ä»¤å‘å¸ƒåŒ…ï¼Œå› ä¸ºæ­¤ç¤ºä¾‹ä¸­ä½¿ç”¨äº†å‘½åç©ºé—´ï¼Œé‚£ä¹ˆåœ¨å‘å¸ƒåŒ…çš„æ—¶å€™éœ€è¦æŒ‡å®šåŒ…ä¸ºå…¬æœ‰åŒ…ï¼Œå› ä¸ºå‘å¸ƒå¸¦æœ‰å‘½åç©ºé—´çš„åŒ… npm ä¼šé»˜è®¤ä¸ºæ˜¯è¦å‘å¸ƒç§æœ‰åŒ…ï¼Œå‘å¸ƒç§æœ‰åŒ…éœ€è¦å¦å¤–ä»˜è´¹çš„å“¦ï¼

æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œé€‰é¡¹ --access public å£°æ˜ä¸ºå…¬æœ‰åŒ…ï¼Œä¹Ÿå¯é€šè¿‡ package.json ä¸­çš„ publicConfig å­—æ®µé…ç½®å£°æ˜ã€‚

```json
{
  "publicConfig": {
    "access": "public"
  }
}
```
å‘å¸ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š

```
> npm publish --access public
npm notice 
npm notice ğŸ“¦  @xqherotools/test@1.0.4
npm notice === Tarball Contents === 
npm notice 230B   .release-it.json
npm notice 142B   CHANGELOG.md    
npm notice 1.1kB  LICENSE         
npm notice 55B    README.md       
npm notice 59B    dist/index.d.ts 
npm notice 159B   dist/index.js   
npm notice 806B   package.json    
npm notice 248B   test/test.js    
npm notice 12.3kB tsconfig.json   
npm notice === Tarball Details === 
npm notice name:          @xqherotools/test                       
npm notice version:       1.0.4                                   
npm notice filename:      @xqherotools/test-1.0.4.tgz             
npm notice package size:  5.4 kB                                  
npm notice unpacked size: 15.1 kB                                 
npm notice shasum:        052f0ea81b7efb2bfa381a19ac970e3dab3af836
npm notice integrity:     sha512-84y8jg0GjiDh0[...]HlrtKG4g1x/Ag==
npm notice total files:   9                                       
npm notice 
npm notice Publishing to https://registry.npmjs.org/
+ @xqherotools/test@1.0.4
```

### æ›´æ–°

åœ¨ä¿®æ”¹åŒ…åï¼Œéœ€è¦å†æ¬¡å‘å¸ƒï¼Œæ­¤æ—¶éœ€è¦éµå®ˆç‰ˆæœ¬å·é€’å¢é€»è¾‘ï¼Œå¦‚ä¸‹ï¼š

- å½“æœ‰ç ´åæ€§ä¸å…¼å®¹çš„ API å˜æ›´æ—¶ï¼Œå‡çº§ä¸»ç‰ˆæœ¬å·
- å½“æ–°å¢ä¸€äº›åŠŸèƒ½ç‰¹æ€§æ—¶ï¼Œå‡çº§æ¬¡ç‰ˆæœ¬å·
- å½“åšä¸€äº› bug ä¿®å¤æ—¶ï¼Œå‡çº§ä¿®è®¢å·

å¯ä»¥ä½¿ç”¨ npm version å‘½ä»¤æ¥ä¿®æ”¹ç‰ˆæœ¬å·:

```bash
npm version [<newversion> | major | minor | patch | premajor | preminor | prepatch | prerelease | from-git]
```
å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š

```bash
# 0.0.0 => 0.0.1
npm version patch
# 0.0.0 => 0.1.0
npm version minor
# 0.0.0 => 1.0.0
npm version major
# 0.0.0 => 0.0.1-0
# === å…ˆè¡Œç‰ˆæœ¬ ===
npm version prepatch
# 0.0.0 => 0.0.1-alpha.0
npm version prepatch --preid=alpha
# 0.0.1-alpha.0 => 0.0.1-alpha.1
npm version prerelease
```

è¯´æ˜ï¼š

- æ‰§è¡Œ npm version å‘½ä»¤æ—¶ï¼Œä¼šä¿®æ”¹ package.json ã€package-lock.json çš„ version å­—æ®µä¸ºå¯¹åº”ç‰ˆæœ¬ï¼›è‹¥å½“å‰ä½¿ç”¨ git æ¥ç®¡ç†æ–‡ä»¶ï¼Œè¿˜ä¼šåˆ›å»ºä¸€æ¡ commit ä¿¡æ¯å’Œåˆ›å»ºä¸€ä¸ª tagï¼Œå¯é€šè¿‡æŒ‡å®š `-no-git-tag-version` å–æ¶ˆç”Ÿæˆ commit å’Œ tagã€‚
- æ‰§è¡Œ npm version å‰ï¼Œgit å·¥ä½œåŒºå’Œæš‚å­˜åŒºç¡®ä¿æ²¡æœ‰æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæ‰§è¡Œå¤±è´¥ã€‚

### release-it è‡ªåŠ¨å‘å¸ƒ

release-it å·¥å…·å¯ä»¥ç”¨æ¥å‡çº§åŒ…ç‰ˆæœ¬ã€ç”Ÿæˆ changgelogã€Git commit \ tag \ pushã€å‘å¸ƒåŒ…ç­‰ã€‚

å‚è€ƒ [release-it å·¥å…·](https://github.com/release-it/release-it)

## æ€»ç»“

æœ¬æ–‡ä»‹ç»äº†npmçš„åŸºæœ¬ä½¿ç”¨ã€é…ç½®ï¼Œè¯¦ç»†è¯´æ˜äº†package.jsonæè¿°æ–‡ä»¶ï¼Œè®²è§£äº†npmçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæœ€åå¯¹å¦‚ä½•åˆ›å»ºå’Œå‘å¸ƒè‡ªå·±çš„npmåŒ…åšäº†è¯¦ç»†çš„æè¿°ã€‚å¸Œæœ›è¿™è¾¹æ–‡ç« å¯¹æ‚¨æœ‰ç”¨ã€‚